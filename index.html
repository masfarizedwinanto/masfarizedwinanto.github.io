
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Manajemen Inventaris Terpadu - SMK NEGERI 1 GOMBONG</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            scroll-behavior: smooth;
        }
        .gradient-bg { 
            background: linear-gradient(135deg, #1e40af 0%, #7c3aed 100%); 
        }
        .card-hover { 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
        }
        .card-hover:hover { 
            transform: translateY(-4px); 
            box-shadow: 0 20px 40px -12px rgba(0, 0, 0, 0.15); 
        }
        .fade-in { 
            animation: fadeIn 0.6s ease-out; 
        }
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(20px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        .notification { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            z-index: 1000; 
            max-width: 400px;
        }
        .input-focus {
            transition: all 0.3s ease;
        }
        .input-focus:focus {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px -5px rgba(59, 130, 246, 0.3);
        }
        .table-row-hover:hover {
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.05) 0%, rgba(124, 58, 237, 0.05) 100%);
        }
        .modal-backdrop {
            backdrop-filter: blur(5px);
            background: rgba(0, 0, 0, 0.5);
        }
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
        }
        .image-preview {
            max-width: 200px;
            max-height: 200px;
            object-fit: cover;
            border-radius: 12px;
        }
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .pulse-dot {
            animation: pulseDot 2s infinite;
        }
        @keyframes pulseDot {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg shadow-2xl relative overflow-hidden">
        <div class="absolute inset-0 bg-black opacity-10"></div>
        <div class="container mx-auto px-6 py-8 relative z-10">
            <div class="flex flex-col lg:flex-row items-center justify-between space-y-4 lg:space-y-0">
                <div class="flex items-center space-x-6">
                    <div class="w-20 h-20 glass-effect rounded-3xl flex items-center justify-center backdrop-blur-sm border border-white border-opacity-20">
                        <span class="text-white text-4xl">üè´</span>
                    </div>
                    <div class="text-center lg:text-left">
                        <h1 class="text-4xl font-bold text-white mb-2">Sistem Manajemen Inventaris Terpadu</h1>
                        <p class="text-blue-100 font-medium text-lg">SMK NEGERI 1 GOMBONG</p>
                        <div class="flex items-center justify-center lg:justify-start space-x-2 mt-2">
                            <span class="w-2 h-2 bg-green-400 rounded-full pulse-dot"></span>
                            <span class="text-blue-100 text-sm">Database Online - Version 1.0</span>
                        </div>
                    </div>
                </div>
                <div class="glass-effect rounded-2xl p-6 backdrop-blur-sm border border-white border-opacity-20">
                    <div class="grid grid-cols-2 gap-6 text-center">
                        <div>
                            <p class="text-white font-semibold text-sm">Total Barang</p>
                            <p class="text-yellow-300 text-3xl font-bold" id="totalItems">0</p>
                        </div>
                        <div>
                            <p class="text-white font-semibold text-sm">Total Kategori</p>
                            <p class="text-green-300 text-3xl font-bold" id="totalCategories">0</p>
                        </div>
                    </div>
                    <div class="mt-4 pt-4 border-t border-white border-opacity-20">
                        <p class="text-blue-100 text-sm" id="currentDate"></p>
                        <p class="text-blue-100 text-xs">Admin: <span class="font-medium text-white">Administrator</span></p>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white shadow-xl sticky top-0 z-40 border-b border-gray-200">
        <div class="container mx-auto px-6">
            <div class="flex flex-wrap justify-center lg:justify-start space-x-2 lg:space-x-8">
                <button onclick="showTab('dashboard')" id="tab-dashboard" class="nav-tab active py-4 px-6 border-b-3 border-blue-600 text-blue-600 font-semibold flex items-center space-x-2 transition-all duration-300">
                    <span>üìä</span><span class="hidden sm:inline">Dashboard</span>
                </button>
                <button onclick="showTab('input')" id="tab-input" class="nav-tab py-4 px-6 border-b-3 border-transparent text-gray-500 hover:text-gray-700 flex items-center space-x-2 transition-all duration-300">
                    <span>‚ûï</span><span class="hidden sm:inline">Input Data</span>
                </button>
                <button onclick="showTab('list')" id="tab-list" class="nav-tab py-4 px-6 border-b-3 border-transparent text-gray-500 hover:text-gray-700 flex items-center space-x-2 transition-all duration-300">
                    <span>üìã</span><span class="hidden sm:inline">Daftar Barang</span>
                </button>
                <button onclick="showTab('settings')" id="tab-settings" class="nav-tab py-4 px-6 border-b-3 border-transparent text-gray-500 hover:text-gray-700 flex items-center space-x-2 transition-all duration-300">
                    <span>‚öôÔ∏è</span><span class="hidden sm:inline">Pengaturan</span>
                </button>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-6 py-8">
        <!-- Dashboard Tab -->
        <div id="dashboard-tab" class="fade-in">
            <!-- Statistics Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-3xl p-6 text-white card-hover">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-blue-100 text-sm font-medium">Total Barang</p>
                            <p class="text-4xl font-bold" id="dashTotalItems">0</p>
                        </div>
                        <div class="text-5xl opacity-80">üì¶</div>
                    </div>
                    <p class="text-blue-100 text-sm">Semua barang terdaftar</p>
                </div>
                
                <div class="bg-gradient-to-br from-green-500 to-green-600 rounded-3xl p-6 text-white card-hover">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-green-100 text-sm font-medium">Kondisi Baik</p>
                            <p class="text-4xl font-bold" id="dashGoodItems">0</p>
                        </div>
                        <div class="text-5xl opacity-80">‚úÖ</div>
                    </div>
                    <p class="text-green-100 text-sm">Barang dalam kondisi baik</p>
                </div>
                
                <div class="bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-3xl p-6 text-white card-hover">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-yellow-100 text-sm font-medium">Perlu Perbaikan</p>
                            <p class="text-4xl font-bold" id="dashNeedRepair">0</p>
                        </div>
                        <div class="text-5xl opacity-80">‚ö†Ô∏è</div>
                    </div>
                    <p class="text-yellow-100 text-sm">Barang perlu diperbaiki</p>
                </div>
                
                <div class="bg-gradient-to-br from-red-500 to-red-600 rounded-3xl p-6 text-white card-hover">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-red-100 text-sm font-medium">Rusak Berat</p>
                            <p class="text-4xl font-bold" id="dashDamaged">0</p>
                        </div>
                        <div class="text-5xl opacity-80">‚ùå</div>
                    </div>
                    <p class="text-red-100 text-sm">Barang rusak berat</p>
                </div>
            </div>

            <!-- Recent Items and Quick Actions -->
            <div class="grid grid-cols-1 xl:grid-cols-2 gap-8">
                <div class="bg-white rounded-3xl shadow-2xl p-8 card-hover">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">üìã Barang Terbaru</h3>
                    <div id="recentItems" class="space-y-4 max-h-96 overflow-y-auto">
                        <!-- Recent items will be populated here -->
                    </div>
                </div>
                
                <div class="bg-white rounded-3xl shadow-2xl p-8 card-hover">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">üöÄ Aksi Cepat</h3>
                    <div class="grid grid-cols-1 gap-4">
                        <button onclick="showTab('input')" class="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-4 rounded-2xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 flex items-center space-x-3">
                            <span class="text-2xl">‚ûï</span>
                            <div class="text-left">
                                <div class="font-semibold">Tambah Barang Baru</div>
                                <div class="text-sm opacity-90">Input data barang inventaris</div>
                            </div>
                        </button>
                        <button onclick="showTab('list')" class="bg-gradient-to-r from-purple-500 to-purple-600 text-white p-4 rounded-2xl hover:from-purple-600 hover:to-purple-700 transition-all duration-300 flex items-center space-x-3">
                            <span class="text-2xl">üìã</span>
                            <div class="text-left">
                                <div class="font-semibold">Lihat Daftar Barang</div>
                                <div class="text-sm opacity-90">Kelola inventaris barang</div>
                            </div>
                        </button>
                        <button onclick="exportAllData()" class="bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-2xl hover:from-green-600 hover:to-green-700 transition-all duration-300 flex items-center space-x-3">
                            <span class="text-2xl">üìä</span>
                            <div class="text-left">
                                <div class="font-semibold">Export Data</div>
                                <div class="text-sm opacity-90">Download laporan lengkap</div>
                            </div>
                        </button>
                        <button onclick="showTab('settings')" class="bg-gradient-to-r from-orange-500 to-orange-600 text-white p-4 rounded-2xl hover:from-orange-600 hover:to-orange-700 transition-all duration-300 flex items-center space-x-3">
                            <span class="text-2xl">‚öôÔ∏è</span>
                            <div class="text-left">
                                <div class="font-semibold">Pengaturan</div>
                                <div class="text-sm opacity-90">Backup & Import Data</div>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Input Data Tab -->
        <div id="input-tab" class="hidden">
            <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-6xl mx-auto card-hover">
                <div class="flex items-center mb-8">
                    <div class="w-16 h-16 bg-gradient-to-r from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center mr-6">
                        <span class="text-3xl text-white">‚ûï</span>
                    </div>
                    <div>
                        <h2 class="text-3xl font-bold text-gray-800">Input Data Barang Inventaris</h2>
                        <p class="text-gray-600 text-lg">Tambahkan barang baru ke dalam database inventaris</p>
                    </div>
                </div>
                
                <form id="itemForm" class="space-y-8">
                    <!-- Basic Information -->
                    <div class="bg-blue-50 rounded-2xl p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">üìù Informasi Dasar</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Kode Barang *</label>
                                <input type="text" id="kodeBarang" class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 input-focus" placeholder="BRG-001" required>
                                <button type="button" onclick="generateItemCode()" class="mt-2 text-blue-600 text-sm font-medium hover:text-blue-800">üé≤ Generate Otomatis</button>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Nama Barang *</label>
                                <input type="text" id="namaBarang" class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 input-focus" placeholder="Laptop Asus VivoBook" required>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Kategori Barang *</label>
                                <select id="kategori" class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 input-focus" required>
                                    <option value="">Pilih Kategori</option>
                                    <option value="Elektronik">üì± Elektronik</option>
                                    <option value="Furniture">ü™ë Furniture</option>
                                    <option value="Alat Tulis">‚úèÔ∏è Alat Tulis</option>
                                    <option value="Peralatan Lab">üî¨ Peralatan Lab</option>
                                    <option value="Kendaraan">üöó Kendaraan</option>
                                    <option value="Buku">üìö Buku</option>
                                    <option value="Olahraga">‚öΩ Peralatan Olahraga</option>
                                    <option value="Keamanan">üîí Keamanan</option>
                                    <option value="Kebersihan">üßπ Kebersihan</option>
                                    <option value="Lainnya">üì¶ Lainnya</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Quantity and Condition -->
                    <div class="bg-green-50 rounded-2xl p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">üìä Kuantitas & Kondisi</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Jumlah *</label>
                                <input type="number" id="jumlah" class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 input-focus" placeholder="1" min="1" required>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Kondisi *</label>
                                <select id="kondisi" class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 input-focus" required>
                                    <option value="">Pilih Kondisi</option>
                                    <option value="Baik">‚úÖ Baik</option>
                                    <option value="Rusak Ringan">‚ö†Ô∏è Rusak Ringan</option>
                                    <option value="Rusak Berat">‚ùå Rusak Berat</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Tahun Pembelian</label>
                                <input type="number" id="tahunPembelian" class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 input-focus" placeholder="2024" min="1900" max="2030">
                            </div>
                        </div>
                    </div>

                    <!-- Photo Upload -->
                    <div class="bg-yellow-50 rounded-2xl p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">üì∑ Foto Barang</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Upload Foto</label>
                                <input type="file" id="fotoBarang" accept="image/*" class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 input-focus" onchange="previewImage(this)">
                                <p class="text-xs text-gray-500 mt-2">Format: JPG, PNG, GIF (Max: 5MB)</p>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Preview</label>
                                <div id="imagePreview" class="w-full h-32 border-2 border-dashed border-gray-300 rounded-xl flex items-center justify-center bg-gray-50">
                                    <span class="text-gray-400">üì∑ Preview foto akan muncul di sini</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Location and Responsibility -->
                    <div class="bg-purple-50 rounded-2xl p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">üìç Lokasi & Tanggung Jawab</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Lokasi Penempatan *</label>
                                <input type="text" id="lokasi" list="locationSuggestions" class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 input-focus" placeholder="Lab Komputer 1" required>
                                <datalist id="locationSuggestions">
                                    <option value="Lab Komputer 1">
                                    <option value="Lab Komputer 2">
                                    <option value="Lab Bahasa">
                                    <option value="Lab IPA">
                                    <option value="Ruang Guru">
                                    <option value="Perpustakaan">
                                    <option value="Ruang Kepala Sekolah">
                                    <option value="Ruang TU">
                                    <option value="Aula">
                                    <option value="Gudang">
                                    <option value="Ruang Kelas X">
                                    <option value="Ruang Kelas XI">
                                    <option value="Ruang Kelas XII">
                                    <option value="Workshop">
                                    <option value="Kantin">
                                </datalist>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Penanggung Jawab</label>
                                <input type="text" id="penanggungJawab" class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 input-focus" placeholder="Nama Guru/Staff">
                            </div>
                        </div>
                    </div>

                    <!-- Additional Information -->
                    <div class="bg-gray-50 rounded-2xl p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">üìù Keterangan Tambahan</h3>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-3">Keterangan</label>
                            <textarea id="keterangan" rows="4" class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 input-focus" placeholder="Keterangan tambahan, spesifikasi, atau catatan khusus..."></textarea>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4">
                        <button type="submit" class="flex-1 bg-gradient-to-r from-blue-600 to-blue-700 text-white py-4 px-8 rounded-2xl hover:from-blue-700 hover:to-blue-800 transition-all duration-300 font-semibold flex items-center justify-center space-x-3 shadow-lg">
                            <span>üíæ</span><span>Simpan ke Database</span>
                        </button>
                        <button type="button" onclick="resetForm()" class="bg-gray-200 text-gray-700 py-4 px-8 rounded-2xl hover:bg-gray-300 transition-all duration-300 font-semibold flex items-center justify-center space-x-3">
                            <span>üîÑ</span><span>Reset Form</span>
                        </button>
                        <button type="button" onclick="previewData()" class="bg-purple-200 text-purple-700 py-4 px-8 rounded-2xl hover:bg-purple-300 transition-all duration-300 font-semibold flex items-center justify-center space-x-3">
                            <span>üëÅÔ∏è</span><span>Preview</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- List Tab -->
        <div id="list-tab" class="hidden">
            <div class="bg-white rounded-3xl shadow-2xl p-8 card-hover">
                <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center mb-8 space-y-4 lg:space-y-0">
                    <div>
                        <h2 class="text-3xl font-bold text-gray-800 flex items-center">
                            <span class="mr-4">üìã</span> Database Inventaris Barang
                        </h2>
                        <p class="text-gray-600 text-lg">Kelola dan pantau semua barang inventaris sekolah</p>
                    </div>
                    <div class="flex flex-wrap gap-3">
                        <div class="relative">
                            <input type="text" id="searchInput" placeholder="üîç Cari barang..." class="pl-4 pr-10 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 input-focus w-64">
                            <button onclick="clearSearch()" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600">‚úï</button>
                        </div>
                        <select id="filterKategori" class="px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 input-focus">
                            <option value="">Semua Kategori</option>
                            <option value="Elektronik">üì± Elektronik</option>
                            <option value="Furniture">ü™ë Furniture</option>
                            <option value="Alat Tulis">‚úèÔ∏è Alat Tulis</option>
                            <option value="Peralatan Lab">üî¨ Peralatan Lab</option>
                            <option value="Kendaraan">üöó Kendaraan</option>
                            <option value="Buku">üìö Buku</option>
                            <option value="Olahraga">‚öΩ Peralatan Olahraga</option>
                            <option value="Keamanan">üîí Keamanan</option>
                            <option value="Kebersihan">üßπ Kebersihan</option>
                            <option value="Lainnya">üì¶ Lainnya</option>
                        </select>
                        <select id="filterKondisi" class="px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 input-focus">
                            <option value="">Semua Kondisi</option>
                            <option value="Baik">‚úÖ Baik</option>
                            <option value="Rusak Ringan">‚ö†Ô∏è Rusak Ringan</option>
                            <option value="Rusak Berat">‚ùå Rusak Berat</option>
                        </select>
                        <button onclick="exportTableData()" class="bg-green-600 text-white px-4 py-3 rounded-xl hover:bg-green-700 transition-all duration-300 font-semibold">
                            üìä Export
                        </button>
                    </div>
                </div>

                <!-- Table -->
                <div class="overflow-x-auto rounded-2xl border border-gray-200">
                    <table class="w-full table-auto">
                        <thead class="bg-gradient-to-r from-blue-50 to-purple-50">
                            <tr>
                                <th class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Foto</th>
                                <th class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Kode</th>
                                <th class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Nama Barang</th>
                                <th class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Kategori</th>
                                <th class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Jumlah</th>
                                <th class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Kondisi</th>
                                <th class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Lokasi</th>
                                <th class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Tahun</th>
                                <th class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">QR Code</th>
                                <th class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="itemTableBody" class="bg-white divide-y divide-gray-200">
                            <!-- Data akan diisi oleh JavaScript -->
                        </tbody>
                    </table>
                </div>

                <!-- Empty State -->
                <div id="emptyState" class="text-center py-16 hidden">
                    <div class="text-8xl mb-6 opacity-50">üì¶</div>
                    <h3 class="text-3xl font-bold text-gray-800 mb-4">Database Masih Kosong</h3>
                    <p class="text-gray-600 mb-8 text-lg">Mulai dengan menambahkan barang pertama ke dalam database</p>
                    <button onclick="showTab('input')" class="bg-gradient-to-r from-blue-600 to-blue-700 text-white px-8 py-4 rounded-2xl hover:from-blue-700 hover:to-blue-800 transition-all duration-300 font-semibold shadow-lg">
                        ‚ûï Tambah Barang Pertama
                    </button>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings-tab" class="hidden">
            <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-4xl mx-auto card-hover">
                <h2 class="text-3xl font-bold text-gray-800 mb-8 flex items-center">
                    <span class="mr-4">‚öôÔ∏è</span> Pengaturan Database
                </h2>
                
                <div class="space-y-8">
                    <!-- Data Management -->
                    <div class="border-b pb-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-6">üìä Manajemen Data</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-blue-50 rounded-2xl p-6">
                                <div class="flex items-center mb-4">
                                    <span class="text-3xl mr-4">üíæ</span>
                                    <div>
                                        <h4 class="font-bold text-gray-800">Backup Database</h4>
                                        <p class="text-sm text-gray-600">Download semua data inventaris</p>
                                    </div>
                                </div>
                                <button onclick="backupData()" class="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white px-6 py-3 rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 font-semibold">
                                    üíæ Backup Sekarang
                                </button>
                            </div>
                            
                            <div class="bg-green-50 rounded-2xl p-6">
                                <div class="flex items-center mb-4">
                                    <span class="text-3xl mr-4">üì•</span>
                                    <div>
                                        <h4 class="font-bold text-gray-800">Import Database</h4>
                                        <p class="text-sm text-gray-600">Restore data dari file backup</p>
                                    </div>
                                </div>
                                <button onclick="document.getElementById('importFile').click()" class="w-full bg-gradient-to-r from-green-500 to-green-600 text-white px-6 py-3 rounded-xl hover:from-green-600 hover:to-green-700 transition-all duration-300 font-semibold">
                                    üì• Import Data
                                </button>
                                <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(event)">
                            </div>
                        </div>
                    </div>

                    <!-- System Info -->
                    <div>
                        <h3 class="text-xl font-semibold text-gray-800 mb-6">‚ÑπÔ∏è Informasi Sistem</h3>
                        <div class="bg-gradient-to-r from-gray-50 to-blue-50 rounded-2xl p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 text-sm">
                                <div class="text-center">
                                    <div class="text-2xl mb-2">üöÄ</div>
                                    <div><strong>Versi Sistem</strong></div>
                                    <div class="text-blue-600 font-bold">1.0</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-2xl mb-2">üì¶</div>
                                    <div><strong>Total Data</strong></div>
                                    <div class="text-green-600 font-bold"><span id="settingsTotalData">0</span> barang</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-2xl mb-2">üïí</div>
                                    <div><strong>Terakhir Update</strong></div>
                                    <div class="text-purple-600 font-bold" id="lastUpdate">-</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-2xl mb-2">üíæ</div>
                                    <div><strong>Storage Used</strong></div>
                                    <div class="text-orange-600 font-bold"><span id="storageUsed">0</span> KB</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- QR Code Modal -->
    <div id="qrModal" class="fixed inset-0 modal-backdrop hidden items-center justify-center z-50">
        <div class="bg-white rounded-3xl p-8 max-w-md mx-4 card-hover shadow-2xl">
            <div class="text-center">
                <h3 class="text-3xl font-bold text-gray-800 mb-6">QR Code Barang</h3>
                <div id="qrCodeContainer" class="mb-6 flex justify-center bg-gray-50 p-6 rounded-2xl"></div>
                <div class="mb-6">
                    <p id="qrItemName" class="font-semibold text-xl text-gray-800"></p>
                    <p id="qrItemCode" class="text-gray-600 text-lg"></p>
                </div>
                <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3">
                    <button onclick="downloadQR()" class="bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 px-6 rounded-2xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 font-semibold flex items-center justify-center space-x-2">
                        <span>üíæ</span><span>Download</span>
                    </button>
                    <button onclick="printQR()" class="bg-gradient-to-r from-green-500 to-green-600 text-white py-3 px-6 rounded-2xl hover:from-green-600 hover:to-green-700 transition-all duration-300 font-semibold flex items-center justify-center space-x-2">
                        <span>üñ®Ô∏è</span><span>Print</span>
                    </button>
                    <button onclick="closeQRModal()" class="bg-gray-300 text-gray-700 py-3 px-6 rounded-2xl hover:bg-gray-400 transition-all duration-300 font-semibold">
                        Tutup
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Preview Modal -->
    <div id="previewModal" class="fixed inset-0 modal-backdrop hidden items-center justify-center z-50">
        <div class="bg-white rounded-3xl p-8 max-w-2xl mx-4 card-hover shadow-2xl max-h-96 overflow-y-auto">
            <div class="text-center">
                <h3 class="text-3xl font-bold text-gray-800 mb-6">Preview Data Barang</h3>
                <div id="previewContent" class="text-left space-y-3">
                    <!-- Preview content will be populated here -->
                </div>
                <div class="flex space-x-3 mt-6">
                    <button onclick="closePreviewModal()" class="bg-gray-300 text-gray-700 py-3 px-6 rounded-2xl hover:bg-gray-400 transition-all duration-300 font-semibold">
                        Tutup
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Detail Modal -->
    <div id="detailModal" class="fixed inset-0 modal-backdrop hidden items-center justify-center z-50">
        <div class="bg-white rounded-3xl p-8 max-w-4xl mx-4 card-hover shadow-2xl max-h-96 overflow-y-auto">
            <div id="detailContent">
                <!-- Detail content will be populated here -->
            </div>
            <div class="flex justify-center mt-6">
                <button onclick="closeDetailModal()" class="bg-gray-300 text-gray-700 py-3 px-6 rounded-2xl hover:bg-gray-400 transition-all duration-300 font-semibold">
                    Tutup
                </button>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="notification"></div>

    <script>
        // Database Management
        let inventoryData = JSON.parse(localStorage.getItem('smk_inventory_database')) || [];
        let currentQRData = null;

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            updateCurrentDate();
            updateAllCounters();
            renderItemTable();
            updateDashboard();
            updateSettings();
            setupEventListeners();
        }

        function setupEventListeners() {
            document.getElementById('searchInput').addEventListener('input', debounce(renderItemTable, 300));
            document.getElementById('filterKategori').addEventListener('change', renderItemTable);
            document.getElementById('filterKondisi').addEventListener('change', renderItemTable);
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Tab Management
        function showTab(tabName) {
            // Hide all tabs
            const tabs = ['dashboard', 'input', 'list', 'settings'];
            tabs.forEach(tab => {
                const tabElement = document.getElementById(tab + '-tab');
                if (tabElement) {
                    tabElement.classList.add('hidden');
                }
            });

            // Show selected tab
            const selectedTab = document.getElementById(tabName + '-tab');
            if (selectedTab) {
                selectedTab.classList.remove('hidden');
                selectedTab.classList.add('fade-in');
            }

            // Update tab buttons
            document.querySelectorAll('.nav-tab').forEach(btn => {
                btn.classList.remove('border-blue-600', 'text-blue-600', 'active');
                btn.classList.add('border-transparent', 'text-gray-500');
            });
            
            const activeTab = document.getElementById('tab-' + tabName);
            if (activeTab) {
                activeTab.classList.remove('border-transparent', 'text-gray-500');
                activeTab.classList.add('border-blue-600', 'text-blue-600', 'active');
            }

            // Update specific tabs
            if (tabName === 'dashboard') {
                updateDashboard();
            } else if (tabName === 'settings') {
                updateSettings();
            }
        }

        // Form Management
        document.getElementById('itemForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = {
                id: Date.now().toString(),
                kodeBarang: document.getElementById('kodeBarang').value.toUpperCase().trim(),
                namaBarang: document.getElementById('namaBarang').value.trim(),
                kategori: document.getElementById('kategori').value,
                jumlah: parseInt(document.getElementById('jumlah').value),
                kondisi: document.getElementById('kondisi').value,
                tahunPembelian: parseInt(document.getElementById('tahunPembelian').value) || null,
                fotoBarang: document.getElementById('imagePreview').querySelector('img')?.src || null,
                lokasi: document.getElementById('lokasi').value.trim(),
                penanggungJawab: document.getElementById('penanggungJawab').value.trim(),
                keterangan: document.getElementById('keterangan').value.trim(),
                tanggalInput: new Date().toLocaleDateString('id-ID'),
                timestamp: Date.now()
            };

            // Validation
            if (!validateFormData(formData)) {
                return;
            }

            // Check for duplicate codes
            if (inventoryData.some(item => item.kodeBarang === formData.kodeBarang)) {
                showNotification('Kode barang sudah ada! Gunakan kode yang berbeda.', 'error');
                document.getElementById('kodeBarang').focus();
                return;
            }

            // Add to database
            inventoryData.push(formData);
            saveData();
            resetForm();
            updateAllCounters();
            renderItemTable();
            updateDashboard();
            
            showNotification('Data barang berhasil disimpan ke database!', 'success');
            
            // Auto switch to list tab
            setTimeout(() => showTab('list'), 1000);
        });

        function validateFormData(data) {
            const errors = [];
            
            if (!data.kodeBarang || data.kodeBarang.length < 3) {
                errors.push('Kode barang minimal 3 karakter');
            }
            
            if (!data.namaBarang || data.namaBarang.length < 2) {
                errors.push('Nama barang minimal 2 karakter');
            }
            
            if (!data.kategori) {
                errors.push('Kategori harus dipilih');
            }
            
            if (!data.kondisi) {
                errors.push('Kondisi harus dipilih');
            }
            
            if (!data.lokasi || data.lokasi.length < 2) {
                errors.push('Lokasi minimal 2 karakter');
            }
            
            if (data.jumlah < 1) {
                errors.push('Jumlah minimal 1');
            }
            
            if (errors.length > 0) {
                showNotification('Error: ' + errors.join(', '), 'error');
                return false;
            }
            
            return true;
        }

        function generateItemCode() {
            const categories = {
                'Elektronik': 'ELK',
                'Furniture': 'FUR',
                'Alat Tulis': 'ATL',
                'Peralatan Lab': 'LAB',
                'Kendaraan': 'KND',
                'Buku': 'BUK',
                'Olahraga': 'OLR',
                'Keamanan': 'SEC',
                'Kebersihan': 'CLN',
                'Lainnya': 'LNY'
            };
            
            const kategori = document.getElementById('kategori').value;
            const prefix = categories[kategori] || 'BRG';
            const timestamp = Date.now().toString().slice(-4);
            const random = Math.floor(Math.random() * 100).toString().padStart(2, '0');
            
            const generatedCode = `${prefix}-${timestamp}${random}`;
            document.getElementById('kodeBarang').value = generatedCode;
            
            showNotification('Kode barang berhasil digenerate!', 'info');
        }

        function previewImage(input) {
            const preview = document.getElementById('imagePreview');
            
            if (input.files && input.files[0]) {
                const file = input.files[0];
                
                // Check file size (5MB limit)
                if (file.size > 5 * 1024 * 1024) {
                    showNotification('Ukuran file terlalu besar! Maksimal 5MB.', 'error');
                    input.value = '';
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.innerHTML = `<img src="${e.target.result}" class="image-preview" alt="Preview">`;
                };
                reader.readAsDataURL(file);
            } else {
                preview.innerHTML = '<span class="text-gray-400">üì∑ Preview foto akan muncul di sini</span>';
            }
        }

        function previewData() {
            const formData = {
                kodeBarang: document.getElementById('kodeBarang').value,
                namaBarang: document.getElementById('namaBarang').value,
                kategori: document.getElementById('kategori').value,
                jumlah: document.getElementById('jumlah').value,
                kondisi: document.getElementById('kondisi').value,
                tahunPembelian: document.getElementById('tahunPembelian').value,
                lokasi: document.getElementById('lokasi').value,
                penanggungJawab: document.getElementById('penanggungJawab').value,
                keterangan: document.getElementById('keterangan').value
            };

            const previewContent = document.getElementById('previewContent');
            previewContent.innerHTML = `
                <div class="grid grid-cols-2 gap-4">
                    <div><strong>Kode Barang:</strong> ${formData.kodeBarang || '-'}</div>
                    <div><strong>Nama Barang:</strong> ${formData.namaBarang || '-'}</div>
                    <div><strong>Kategori:</strong> ${formData.kategori || '-'}</div>
                    <div><strong>Jumlah:</strong> ${formData.jumlah || '-'}</div>
                    <div><strong>Kondisi:</strong> ${formData.kondisi || '-'}</div>
                    <div><strong>Tahun Pembelian:</strong> ${formData.tahunPembelian || '-'}</div>
                    <div><strong>Lokasi:</strong> ${formData.lokasi || '-'}</div>
                    <div><strong>Penanggung Jawab:</strong> ${formData.penanggungJawab || '-'}</div>
                    <div class="col-span-2"><strong>Keterangan:</strong> ${formData.keterangan || '-'}</div>
                </div>
            `;

            document.getElementById('previewModal').classList.remove('hidden');
            document.getElementById('previewModal').classList.add('flex');
        }

        function closePreviewModal() {
            document.getElementById('previewModal').classList.add('hidden');
            document.getElementById('previewModal').classList.remove('flex');
        }

        function resetForm() {
            document.getElementById('itemForm').reset();
            document.getElementById('imagePreview').innerHTML = '<span class="text-gray-400">üì∑ Preview foto akan muncul di sini</span>';
            showNotification('Form berhasil direset!', 'info');
        }

        // Table Rendering
        function renderItemTable() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const filterCategory = document.getElementById('filterKategori').value;
            const filterCondition = document.getElementById('filterKondisi').value;
            
            let filteredData = inventoryData.filter(item => {
                const matchesSearch = item.namaBarang.toLowerCase().includes(searchTerm) || 
                                    item.kodeBarang.toLowerCase().includes(searchTerm) ||
                                    item.lokasi.toLowerCase().includes(searchTerm) ||
                                    (item.penanggungJawab && item.penanggungJawab.toLowerCase().includes(searchTerm));
                const matchesCategory = !filterCategory || item.kategori === filterCategory;
                const matchesCondition = !filterCondition || item.kondisi === filterCondition;
                return matchesSearch && matchesCategory && matchesCondition;
            });

            const tbody = document.getElementById('itemTableBody');
            const emptyState = document.getElementById('emptyState');

            if (filteredData.length === 0) {
                tbody.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }

            emptyState.classList.add('hidden');
            
            tbody.innerHTML = filteredData.map((item, index) => `
                <tr class="table-row-hover transition-all duration-200">
                    <td class="px-6 py-4 whitespace-nowrap">
                        ${item.fotoBarang ? 
                            `<img src="${item.fotoBarang}" class="w-16 h-16 object-cover rounded-lg cursor-pointer" onclick="showItemDetail('${item.id}')" alt="Foto ${item.namaBarang}">` : 
                            '<div class="w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center text-gray-400 text-xs">No Photo</div>'
                        }
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="font-mono text-sm font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded-lg">${item.kodeBarang}</span>
                    </td>
                    <td class="px-6 py-4">
                        <div class="font-semibold text-gray-900 text-lg">${item.namaBarang}</div>
                        ${item.penanggungJawab ? `<div class="text-sm text-gray-500">üë§ ${item.penanggungJawab}</div>` : ''}
                        ${item.keterangan ? `<div class="text-xs text-gray-400 mt-1">${item.keterangan.substring(0, 50)}${item.keterangan.length > 50 ? '...' : ''}</div>` : ''}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="text-sm text-gray-900 bg-gray-100 px-3 py-1 rounded-full">${item.kategori}</span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="font-bold text-2xl text-gray-900">${item.jumlah}</span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-4 py-2 inline-flex text-sm leading-5 font-semibold rounded-full ${getConditionColor(item.kondisi)}">
                            ${getConditionIcon(item.kondisi)} ${item.kondisi}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900 font-medium">üìç ${item.lokasi}</div>
                        <div class="text-xs text-gray-500">${item.tanggalInput}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${item.tahunPembelian ? `<span class="font-semibold text-purple-600">${item.tahunPembelian}</span>` : '<span class="text-gray-400">-</span>'}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <button onclick="showQRCode('${item.id}')" class="bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 py-2 rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 font-medium shadow-lg">
                            üì± QR Code
                        </button>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex space-x-2">
                            <button onclick="showItemDetail('${item.id}')" class="bg-gradient-to-r from-green-400 to-green-500 text-white px-3 py-2 rounded-xl hover:from-green-500 hover:to-green-600 transition-all duration-300 text-sm font-medium shadow-lg">
                                üëÅÔ∏è Detail
                            </button>
                            <button onclick="editItem('${item.id}')" class="bg-gradient-to-r from-yellow-400 to-yellow-500 text-white px-3 py-2 rounded-xl hover:from-yellow-500 hover:to-yellow-600 transition-all duration-300 text-sm font-medium shadow-lg">
                                ‚úèÔ∏è Edit
                            </button>
                            <button onclick="deleteItem('${item.id}')" class="bg-gradient-to-r from-red-500 to-red-600 text-white px-3 py-2 rounded-xl hover:from-red-600 hover:to-red-700 transition-all duration-300 text-sm font-medium shadow-lg">
                                üóëÔ∏è Hapus
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function clearSearch() {
            document.getElementById('searchInput').value = '';
            renderItemTable();
        }

        function getConditionColor(kondisi) {
            switch(kondisi) {
                case 'Baik': return 'bg-green-100 text-green-800';
                case 'Rusak Ringan': return 'bg-yellow-100 text-yellow-800';
                case 'Rusak Berat': return 'bg-red-100 text-red-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        function getConditionIcon(kondisi) {
            switch(kondisi) {
                case 'Baik': return '‚úÖ';
                case 'Rusak Ringan': return '‚ö†Ô∏è';
                case 'Rusak Berat': return '‚ùå';
                default: return '‚ùì';
            }
        }

        // Item Detail Modal
        function showItemDetail(itemId) {
            const item = inventoryData.find(i => i.id === itemId);
            if (!item) return;

            const detailContent = document.getElementById('detailContent');
            detailContent.innerHTML = `
                <div class="text-center mb-6">
                    <h3 class="text-3xl font-bold text-gray-800">Detail Barang</h3>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div>
                        ${item.fotoBarang ? 
                            `<img src="${item.fotoBarang}" class="w-full h-64 object-cover rounded-2xl shadow-lg" alt="Foto ${item.namaBarang}">` : 
                            '<div class="w-full h-64 bg-gray-200 rounded-2xl flex items-center justify-center text-gray-400 text-lg">üì∑ Tidak ada foto</div>'
                        }
                    </div>
                    <div class="space-y-4">
                        <div class="bg-blue-50 p-4 rounded-xl">
                            <h4 class="font-bold text-gray-800 mb-2">üìù Informasi Dasar</h4>
                            <div class="space-y-2 text-sm">
                                <div><strong>Kode:</strong> ${item.kodeBarang}</div>
                                <div><strong>Nama:</strong> ${item.namaBarang}</div>
                                <div><strong>Kategori:</strong> ${item.kategori}</div>
                                <div><strong>Jumlah:</strong> ${item.jumlah}</div>
                            </div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-xl">
                            <h4 class="font-bold text-gray-800 mb-2">üìä Status & Kondisi</h4>
                            <div class="space-y-2 text-sm">
                                <div><strong>Kondisi:</strong> <span class="px-2 py-1 rounded-full text-xs ${getConditionColor(item.kondisi)}">${getConditionIcon(item.kondisi)} ${item.kondisi}</span></div>
                                <div><strong>Tahun Pembelian:</strong> ${item.tahunPembelian || '-'}</div>
                                <div><strong>Tanggal Input:</strong> ${item.tanggalInput}</div>
                            </div>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-xl">
                            <h4 class="font-bold text-gray-800 mb-2">üìç Lokasi & PJ</h4>
                            <div class="space-y-2 text-sm">
                                <div><strong>Lokasi:</strong> ${item.lokasi}</div>
                                <div><strong>Penanggung Jawab:</strong> ${item.penanggungJawab || '-'}</div>
                            </div>
                        </div>
                        ${item.keterangan ? `
                        <div class="bg-yellow-50 p-4 rounded-xl">
                            <h4 class="font-bold text-gray-800 mb-2">üìù Keterangan</h4>
                            <p class="text-sm">${item.keterangan}</p>
                        </div>
                        ` : ''}
                    </div>
                </div>
            `;

            document.getElementById('detailModal').classList.remove('hidden');
            document.getElementById('detailModal').classList.add('flex');
        }

        function closeDetailModal() {
            document.getElementById('detailModal').classList.add('hidden');
            document.getElementById('detailModal').classList.remove('flex');
        }

        // QR Code functionality
        function showQRCode(itemId) {
            const item = inventoryData.find(i => i.id === itemId);
            if (!item) return;

            const qrData = `SMK NEGERI 1 GOMBONG - INVENTARIS
Kode: ${item.kodeBarang}
Nama: ${item.namaBarang}
Kategori: ${item.kategori}
Lokasi: ${item.lokasi}
Kondisi: ${item.kondisi}
Tanggal: ${item.tanggalInput}
Database: v1.0`;
            
            const qrContainer = document.getElementById('qrCodeContainer');
            qrContainer.innerHTML = '<div class="loading-spinner mx-auto"></div>';
            
            QRCode.toCanvas(qrData, { 
                width: 280, 
                height: 280,
                margin: 2,
                color: {
                    dark: '#1e40af',
                    light: '#FFFFFF'
                },
                errorCorrectionLevel: 'M'
            }, function (error, canvas) {
                if (error) {
                    console.error(error);
                    qrContainer.innerHTML = '<p class="text-red-500">Error generating QR code</p>';
                    return;
                }
                qrContainer.innerHTML = '';
                qrContainer.appendChild(canvas);
                currentQRData = { canvas, item };
            });

            document.getElementById('qrItemName').textContent = item.namaBarang;
            document.getElementById('qrItemCode').textContent = `Kode: ${item.kodeBarang}`;
            document.getElementById('qrModal').classList.remove('hidden');
            document.getElementById('qrModal').classList.add('flex');
        }

        function closeQRModal() {
            document.getElementById('qrModal').classList.add('hidden');
            document.getElementById('qrModal').classList.remove('flex');
        }

        function downloadQR() {
            if (!currentQRData) return;
            
            const link = document.createElement('a');
            link.download = `QR_${currentQRData.item.kodeBarang}_${currentQRData.item.namaBarang.replace(/[^a-zA-Z0-9]/g, '_')}.png`;
            link.href = currentQRData.canvas.toDataURL('image/png', 1.0);
            link.click();
            
            showNotification('QR Code berhasil didownload!', 'success');
        }

        function printQR() {
            if (!currentQRData) return;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>QR Code - ${currentQRData.item.namaBarang}</title>
                    <style>
                        body { text-align: center; font-family: Arial, sans-serif; margin: 20px; }
                        .header { margin-bottom: 20px; }
                        .qr-container { margin: 20px 0; }
                        .details { margin-top: 20px; text-align: left; max-width: 400px; margin-left: auto; margin-right: auto; }
                        .details div { margin: 5px 0; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h2>SMK NEGERI 1 GOMBONG</h2>
                        <h3>Database Inventaris - QR Code</h3>
                    </div>
                    <div class="qr-container">
                        <img src="${currentQRData.canvas.toDataURL()}" style="border: 2px solid #ddd; padding: 10px;">
                    </div>
                    <div class="details">
                        <div><strong>Nama Barang:</strong> ${currentQRData.item.namaBarang}</div>
                        <div><strong>Kode:</strong> ${currentQRData.item.kodeBarang}</div>
                        <div><strong>Kategori:</strong> ${currentQRData.item.kategori}</div>
                        <div><strong>Lokasi:</strong> ${currentQRData.item.lokasi}</div>
                        <div><strong>Kondisi:</strong> ${currentQRData.item.kondisi}</div>
                        <div><strong>Tanggal Input:</strong> ${currentQRData.item.tanggalInput}</div>
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        // Item management functions
        function editItem(itemId) {
            const item = inventoryData.find(i => i.id === itemId);
            if (!item) return;

            // Fill form with item data
            document.getElementById('kodeBarang').value = item.kodeBarang;
            document.getElementById('namaBarang').value = item.namaBarang;
            document.getElementById('kategori').value = item.kategori;
            document.getElementById('jumlah').value = item.jumlah;
            document.getElementById('kondisi').value = item.kondisi;
            document.getElementById('tahunPembelian').value = item.tahunPembelian || '';
            document.getElementById('lokasi').value = item.lokasi;
            document.getElementById('penanggungJawab').value = item.penanggungJawab || '';
            document.getElementById('keterangan').value = item.keterangan || '';

            // Handle photo
            if (item.fotoBarang) {
                document.getElementById('imagePreview').innerHTML = `<img src="${item.fotoBarang}" class="image-preview" alt="Preview">`;
            }

            // Remove item from array (will be re-added when form is submitted)
            inventoryData = inventoryData.filter(i => i.id !== itemId);
            saveData();

            // Switch to input tab
            showTab('input');
            showNotification('Data dimuat untuk diedit. Silakan ubah dan simpan kembali.', 'info');
        }

        function deleteItem(itemId) {
            const item = inventoryData.find(i => i.id === itemId);
            if (!item) return;

            if (confirm(`Apakah Anda yakin ingin menghapus barang "${item.namaBarang}"?\n\nTindakan ini tidak dapat dibatalkan.`)) {
                inventoryData = inventoryData.filter(i => i.id !== itemId);
                saveData();
                updateAllCounters();
                renderItemTable();
                updateDashboard();
                showNotification('Barang berhasil dihapus dari database!', 'success');
            }
        }

        // Dashboard functions
        function updateDashboard() {
            updateAllCounters();
            updateRecentItems();
        }

        function updateAllCounters() {
            const totalItems = inventoryData.reduce((sum, item) => sum + item.jumlah, 0);
            const totalCategories = [...new Set(inventoryData.map(item => item.kategori))].length;
            const goodItems = inventoryData.filter(item => item.kondisi === 'Baik').reduce((sum, item) => sum + item.jumlah, 0);
            const needRepair = inventoryData.filter(item => item.kondisi === 'Rusak Ringan').reduce((sum, item) => sum + item.jumlah, 0);
            const damaged = inventoryData.filter(item => item.kondisi === 'Rusak Berat').reduce((sum, item) => sum + item.jumlah, 0);

            document.getElementById('totalItems').textContent = totalItems;
            document.getElementById('totalCategories').textContent = totalCategories;
            document.getElementById('dashTotalItems').textContent = totalItems;
            document.getElementById('dashGoodItems').textContent = goodItems;
            document.getElementById('dashNeedRepair').textContent = needRepair;
            document.getElementById('dashDamaged').textContent = damaged;
        }

        function updateRecentItems() {
            const recentItems = document.getElementById('recentItems');
            const recentData = inventoryData.slice(-10).reverse();

            if (recentData.length === 0) {
                recentItems.innerHTML = '<div class="text-center py-8"><div class="text-4xl mb-2 opacity-50">üì¶</div><p class="text-gray-500">Belum ada barang</p></div>';
                return;
            }

            recentItems.innerHTML = recentData.map((item, index) => `
                <div class="flex items-center space-x-4 p-4 bg-gradient-to-r from-gray-50 to-blue-50 rounded-2xl border border-gray-100 hover:shadow-md transition-all duration-300 cursor-pointer" onclick="showItemDetail('${item.id}')">
                    <div class="w-12 h-12 rounded-xl overflow-hidden flex-shrink-0">
                        ${item.fotoBarang ? 
                            `<img src="${item.fotoBarang}" class="w-full h-full object-cover" alt="${item.namaBarang}">` : 
                            '<div class="w-full h-full bg-gray-200 flex items-center justify-center text-gray-400 text-xs">üì¶</div>'
                        }
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="text-sm font-semibold text-gray-800 truncate">${item.namaBarang}</p>
                        <p class="text-xs text-gray-500">${item.kodeBarang} ‚Ä¢ ${item.kategori}</p>
                        <p class="text-xs text-gray-400">${item.tanggalInput}</p>
                    </div>
                    <div class="text-right">
                        <span class="px-2 py-1 text-xs rounded-full ${getConditionColor(item.kondisi)}">${getConditionIcon(item.kondisi)}</span>
                        <p class="text-xs text-gray-500 mt-1">${item.jumlah} unit</p>
                    </div>
                </div>
            `).join('');
        }

        // Settings functions
        function updateSettings() {
            document.getElementById('settingsTotalData').textContent = inventoryData.length;
            document.getElementById('lastUpdate').textContent = new Date().toLocaleString('id-ID');
            
            const dataSize = JSON.stringify(inventoryData).length;
            document.getElementById('storageUsed').textContent = Math.round(dataSize / 1024);
        }

        function backupData() {
            const backupData = {
                inventoryData: inventoryData,
                backupDate: new Date().toISOString(),
                version: '1.0',
                school: 'SMK NEGERI 1 GOMBONG'
            };

            const dataStr = JSON.stringify(backupData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `SMK_Inventory_Backup_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            showNotification('Database berhasil dibackup!', 'success');
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (importedData.inventoryData && Array.isArray(importedData.inventoryData)) {
                        if (confirm(`Apakah Anda yakin ingin mengimport data?\n\nData saat ini akan diganti dengan ${importedData.inventoryData.length} item dari backup.\n\nTindakan ini tidak dapat dibatalkan.`)) {
                            inventoryData = importedData.inventoryData;
                            saveData();
                            updateAllCounters();
                            renderItemTable();
                            updateDashboard();
                            updateSettings();
                            showNotification(`Berhasil mengimport ${importedData.inventoryData.length} item!`, 'success');
                        }
                    } else {
                        showNotification('Format file tidak valid!', 'error');
                    }
                } catch (error) {
                    showNotification('Error membaca file: ' + error.message, 'error');
                }
            };
            reader.readAsText(file);
            
            // Reset file input
            event.target.value = '';
        }

        // Export functions
        function exportAllData() {
            exportToCSV();
        }

        function exportTableData() {
            exportToCSV();
        }

        function exportToCSV() {
            const headers = [
                'No', 'Kode Barang', 'Nama Barang', 'Kategori', 'Jumlah', 'Kondisi', 
                'Tahun Pembelian', 'Lokasi', 'Penanggung Jawab', 'Keterangan', 'Tanggal Input'
            ];
            
            const csvContent = [
                headers.join(','),
                ...inventoryData.map((item, index) => [
                    index + 1,
                    item.kodeBarang,
                    `"${item.namaBarang}"`,
                    item.kategori,
                    item.jumlah,
                    item.kondisi,
                    item.tahunPembelian || '',
                    `"${item.lokasi}"`,
                    `"${item.penanggungJawab || ''}"`,
                    `"${item.keterangan || ''}"`,
                    item.tanggalInput
                ].join(','))
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `Database_Inventaris_SMK_Gombong_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
            
            showNotification('Data berhasil diexport ke CSV!', 'success');
        }

        // Utility functions
        function updateCurrentDate() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('id-ID', options);
        }

        function saveData() {
            localStorage.setItem('smk_inventory_database', JSON.stringify(inventoryData));
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                info: 'bg-blue-500',
                warning: 'bg-yellow-500'
            };
            
            notification.className = `${colors[type]} text-white px-6 py-4 rounded-2xl shadow-2xl mb-4 slide-in`;
            notification.innerHTML = `
                <div class="flex items-center space-x-3">
                    <span class="text-2xl">${type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è'}</span>
                    <span class="font-semibold">${message}</span>
                </div>
            `;
            
            document.getElementById('notificationContainer').appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }

        // Initialize date update
        setInterval(updateCurrentDate, 60000);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9748321cf25c6198',t:'MTc1NjA5NDU2Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
